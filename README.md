## インストールと実行

### インストール

```
npm install
```

### ビルド
```
npm run build
```

### 実行
このアプリケーションを実行するには、[シメキリbotの設定画面](https://html5exp.slack.com/services/B0VD9R144)でAPIトークンを取得し、コマンドラインパラメータに指定する必要がある。
また、`--database-url`オプションを使用して、データベースのURLを指定する必要もある。
```
# アプリケーションに渡すコマンドライン引数は、"--"の後に記述する
npm start -- --token <SlackのAPIトークン> --database-url <データベースのURL。例: mysql://user:pass@localhost:3306/hx>
```


その他のコマンドラインパラメータを確認するには、--helpオプションの出力を確認すること。

```
npm start -- -h
```


### ウォッチ＆ビルド（開発時）
```
npm run watch:build
```
## 仕様
このボットは、HXの運営を円滑にするために以下の機能を備える。

### ヘルプ

```
@simekiri: help
```

### 記事執筆予定の登録機能

HX Slack上のいかなるチャネル上でも（DMを含む）、simekiri botにメンションすることで執筆予定の登録を行うことが出来る。
メンションの形式は以下。

```
@simekiri add -t <title> -w @<writer> -d <date> [-e @<editor>]
```

このメンションに対する応答は以下のようになる。

```
シメキリ設定しました！

- 登録番号: <id>
- 仮タイトル: <title>
- 書く人: @<writer>
- 担当: @<sender>
- シメキリ: <date>

シメキリが近づいたら随時お知らせします。
執筆頑張ってください！
```

この操作は、編集者しか行うことができない。

### 通知機能

シメキリが近づくと、自動的に著者と担当者に向けて通知が行われる。
通知の仕様は以下。

- 著者と担当者を宛先に付けたダイレクトメッセージが送信される。
- シメキリ1週間前/3日前/1日前/1日後に通知が行われる。

この操作は、botが自動的に行う。

### 記事執筆予定の更新機能

執筆者の都合で、記事執筆予定を更新しなくてはならなくなった場合に、
simekiri botに対して以下のメンションを行うことで予定を更新することが出来る。

```
@simekiri update -i <id> [-d <date>] [-t <title>]
```

この操作は、編集者しか行うことができない。

### 記事執筆予定の解除機能

執筆予定をキャンセルする場合は、以下のようにsimekiri botにメンションを行う。

```
@simekiri remove <id>
```

この操作は、編集者しか行うことができない。

### 記事執筆の完了

執筆が完了したら、以下のようにsimekiri botにメンションを行う。

```
@simekiri done <id>
```

この操作は、編集者しか行うことができない。

### 記事執筆予定の一覧を表示する

```
@simekiri list <id>
```

この操作は、誰でも行うことが出来る。
